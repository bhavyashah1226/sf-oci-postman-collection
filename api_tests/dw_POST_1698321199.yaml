# Test generated by RoostGPT for test demo1 using AI Type Azure Open AI and AI Model roost-gpt4-32k

config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "dw_POST_1698321199.csv"
    fields:
      - "grant_type"
      - "scope"
    skipHeader: true

scenarios:
  - name: 'Successful API request'
    flow:
      - post:
          url: "/dw/oauth2/access_token"
          headers:
            Content-Type: "application/json"
          json:
            grant_type: "{{ grant_type }}"
            scope: "{{ api_scopes }}"
          capture:
            - json: "$.access_token"
              as: "_authorization_key"
          expect:
            - statusCode: 200
            - hasProperty: "token_type"
            - hasProperty: "access_token"

  - name: "API request with validation failure"
    flow:
      - post:
          url: "/wrong/url"
          headers:
            Content-Type: "application/json"
          json: 
            grant_type: "{{ grant_type }}"
            scope: "{{ api_scopes }}"
          expect:
            - statusCode: 400

  - name: "API request with edge case"
    flow:
      - post:
          url: "/dw/oauth2/access_token"
          headers:
            Content-Type: "application/json"
          json:
            grant_type: "edg#ecas#e..."
            scope: "{{ api_scopes }}"
          expect:
            - statusCode: 200
            - hasProperty: "token_type"
            - hasProperty: "access_token"
